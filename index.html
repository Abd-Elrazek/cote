<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Cote by dashersw</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Cote</h1>
      <h2 class="project-tagline">An auto-discovery mesh network framework for building fault-tolerant and scalable applications</h2>
      <a href="https://github.com/dashersw/cote" class="btn">View on GitHub</a>
      <a href="https://github.com/dashersw/cote/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/dashersw/cote/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="cote" class="anchor" href="#cote" aria-hidden="true"><span class="octicon octicon-link"></span></a>cote</h1>

<p>cote is an auto-discovery mesh network framework for building fault-tolerant and scalable applications. It hosts components that let you write programs that discover each other over LAN and communicate in various schemes.</p>

<p>Join us on <a href="http://slack.cotejs.org"><img src="http://slack.cotejs.org/badge.svg" alt="cote Slack"></a> for anything related to cote.</p>

<p>Cote is built upon networking and messaging libraries such as <a href="https://github.com/visionmedia/axon">axon</a> and <a href="https://github.com/wankdanker/node-discover">node-discover</a>.</p>

<h2>
<a id="motivation" class="anchor" href="#motivation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Motivation</h2>

<p>Tomorrow belongs to distributed software. As CPU performance is heavily dictated by the number of cores and the power of each core is already at its limits, distributed computing will decide how your application performs. Distributed systems also pose great architectural benefits such as fault-tolerance and scalability.</p>

<p>Components of such a distributed system should be able to find other components <a href="http://en.wikipedia.org/wiki/Zero_configuration_networking">zeroconf</a> and communicate over a set of conventions. Sometimes they may work as a cluster, may include a pub/sub mechanism, or a request/response mechanism. Cote brings you the advantages of distributed software. Think of it like homing pigeons.</p>

<h2>
<a id="installing" class="anchor" href="#installing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installing</h2>

<ul>
<li>via npm<br>
<code>npm install cote</code>
</li>
<li>via git<br>
<code>git clone git://github.com/dashersw/cote.git</code>
</li>
</ul>

<h2>
<a id="components" class="anchor" href="#components" aria-hidden="true"><span class="octicon octicon-link"></span></a>Components</h2>

<p>All components support namespaces. Given as the configuration object to the constructor, components adhere and act on namespaces if provided, and ignore other messages.</p>

<h3>
<a id="requester" class="anchor" href="#requester" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requester</h3>

<p>Requester queues requests until a Responder is available, and once so, it delivers the request. Requests will be dispatched to Responders in a round-robin way.</p>

<p>Example:</p>

<div class="highlight highlight-js"><pre><span class="pl-k">var</span> Requester <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>cote<span class="pl-pds">'</span></span>).Requester;

<span class="pl-k">var</span> randomRequest <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Requester</span>({
    name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>randomReq<span class="pl-pds">'</span></span>,
    <span class="pl-c">// namespace: 'rnd',</span>
    requests<span class="pl-k">:</span> [<span class="pl-s"><span class="pl-pds">'</span>randomRequest<span class="pl-pds">'</span></span>]
});

randomRequest.on(<span class="pl-s"><span class="pl-pds">'</span>ready<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>() {
    <span class="pl-c1">setInterval</span>(<span class="pl-k">function</span>() {
        <span class="pl-k">var</span> req <span class="pl-k">=</span> {
            type<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>randomRequest<span class="pl-pds">'</span></span>,
            val<span class="pl-k">:</span> <span class="pl-k">~~</span>(<span class="pl-c1">Math</span>.<span class="pl-c1">random</span>() <span class="pl-k">*</span> <span class="pl-c1">10</span>)
        };

        randomRequest.<span class="pl-c1">send</span>(req, <span class="pl-k">function</span>(<span class="pl-smi">res</span>) {
            <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>request<span class="pl-pds">'</span></span>, req, <span class="pl-s"><span class="pl-pds">'</span>answer<span class="pl-pds">'</span></span>, res);
        });
    }, <span class="pl-c1">5000</span>);
});</pre></div>

<h3>
<a id="responder" class="anchor" href="#responder" aria-hidden="true"><span class="octicon octicon-link"></span></a>Responder</h3>

<p>Responder is a component for responding to certain requests from a Requester. It's a descendant of EventEmitter2, and requests are regular events, therefore may be wildcarded or namespaced.</p>

<p>Responder may be used to add new modules to existing web servers / applications without ever changing the main server code. Only a Requester will be able to utilize a Responder.</p>

<p>Example:</p>

<div class="highlight highlight-js"><pre><span class="pl-k">var</span> Responder <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>cote<span class="pl-pds">'</span></span>).Responder;

<span class="pl-c">// Instantiate a new Responder component.</span>
<span class="pl-k">var</span> randomResponder <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Responder</span>({
    name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>randomRep<span class="pl-pds">'</span></span>,
    <span class="pl-c">// namespace: 'rnd',</span>
    respondsTo<span class="pl-k">:</span> [<span class="pl-s"><span class="pl-pds">'</span>randomRequest<span class="pl-pds">'</span></span>] <span class="pl-c">// types of requests this responder</span>
                                  <span class="pl-c">// can respond to.</span>
});

<span class="pl-c">// request handlers are like any event handler.</span>
randomResponder.on(<span class="pl-s"><span class="pl-pds">'</span>randomRequest<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">req</span>, <span class="pl-smi">cb</span>) {
    <span class="pl-k">var</span> answer <span class="pl-k">=</span> <span class="pl-k">~~</span>(<span class="pl-c1">Math</span>.<span class="pl-c1">random</span>() <span class="pl-k">*</span> <span class="pl-c1">10</span>);
    <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>request<span class="pl-pds">'</span></span>, req.val, <span class="pl-s"><span class="pl-pds">'</span>answering with<span class="pl-pds">'</span></span>, answer);
    cb(answer);
});</pre></div>

<h3>
<a id="publisher" class="anchor" href="#publisher" aria-hidden="true"><span class="octicon octicon-link"></span></a>Publisher</h3>

<p>Publisher is a component for publishing certain events with arbitrary data. It may be used as a distributed EventEmitter. It may also be used in a scenario where some components need to be notified of updates, such as new tweets, etc. instead of polling for them. Only a subscriber will get notifications from a Publisher.</p>

<p>Example:</p>

<div class="highlight highlight-js"><pre><span class="pl-k">var</span> Publisher <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>cote<span class="pl-pds">'</span></span>).Publisher;

<span class="pl-c">// Instantiate a new Publisher component.</span>
<span class="pl-k">var</span> randomPublisher <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Publisher</span>({
    name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>randomPub<span class="pl-pds">'</span></span>,
    <span class="pl-c">// namespace: 'rnd',</span>
    broadcasts<span class="pl-k">:</span> [<span class="pl-s"><span class="pl-pds">'</span>randomUpdate<span class="pl-pds">'</span></span>]
});

<span class="pl-c">// Wait for the publisher to find an open port and listen on it.</span>
randomPublisher.on(<span class="pl-s"><span class="pl-pds">'</span>ready<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>() {
    <span class="pl-c1">setInterval</span>(<span class="pl-k">function</span>() {
        <span class="pl-k">var</span> val <span class="pl-k">=</span> {
            val<span class="pl-k">:</span> <span class="pl-k">~~</span>(<span class="pl-c1">Math</span>.<span class="pl-c1">random</span>() <span class="pl-k">*</span> <span class="pl-c1">1000</span>)
        };

        <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>emitting<span class="pl-pds">'</span></span>, val);

        <span class="pl-c">// publish an event with arbitrary data at any time</span>
        randomPublisher.publish(<span class="pl-s"><span class="pl-pds">'</span>randomUpdate<span class="pl-pds">'</span></span>, val);
    }, <span class="pl-c1">3000</span>);
});</pre></div>

<h3>
<a id="subscriber" class="anchor" href="#subscriber" aria-hidden="true"><span class="octicon octicon-link"></span></a>Subscriber</h3>

<p>Subscriber subscribes to events emitted from a Publisher.</p>

<p>Example:</p>

<div class="highlight highlight-js"><pre><span class="pl-k">var</span> Subscriber <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>cote<span class="pl-pds">'</span></span>).Subscriber;

<span class="pl-k">var</span> randomSubscriber <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Subscriber</span>({
    name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>randomSub<span class="pl-pds">'</span></span>,
    <span class="pl-c">// namespace: 'rnd',</span>
    subscribesTo<span class="pl-k">:</span> [<span class="pl-s"><span class="pl-pds">'</span>randomUpdate<span class="pl-pds">'</span></span>]
});

randomSubscriber.on(<span class="pl-s"><span class="pl-pds">'</span>randomUpdate<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">req</span>) {
    <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>notified of <span class="pl-pds">'</span></span>, req);
});</pre></div>

<h3>
<a id="sockend" class="anchor" href="#sockend" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sockend</h3>

<p>Sockend is the glue for carrying all the possibilities of cote to the next level with WebSockets over socket.io. Sockend makes Responders and Publishers available to the front-end and adhere to socket.io namespaces. It's the magic for distributed web apps.</p>

<p>Example:
<code>index.html</code></p>

<div class="highlight highlight-html"><pre>&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>/socket.io/socket.io.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;
<span class="pl-s1">&lt;<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">  <span class="pl-k">var</span> socket <span class="pl-k">=</span> io.connect(<span class="pl-s"><span class="pl-pds">'</span>http://localhost<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">  <span class="pl-k">var</span> socket2 <span class="pl-k">=</span> io.connect(<span class="pl-s"><span class="pl-pds">'</span>http://localhost/rnd<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1">  <span class="pl-c1">setInterval</span>(<span class="pl-k">function</span>() {</span>
<span class="pl-s1">    <span class="pl-k">var</span> req <span class="pl-k">=</span> {</span>
<span class="pl-s1">      val<span class="pl-k">:</span> <span class="pl-k">~~</span>(<span class="pl-c1">Math</span>.<span class="pl-c1">random</span>() <span class="pl-k">*</span> <span class="pl-c1">10</span>)</span>
<span class="pl-s1">    };</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-k">var</span> req2 <span class="pl-k">=</span> {</span>
<span class="pl-s1">      val<span class="pl-k">:</span> <span class="pl-k">~~</span>(<span class="pl-c1">Math</span>.<span class="pl-c1">random</span>() <span class="pl-k">*</span> <span class="pl-c1">10</span>)</span>
<span class="pl-s1">    };</span>
<span class="pl-s1"></span>
<span class="pl-s1">    socket.emit(<span class="pl-s"><span class="pl-pds">'</span>randomRequest<span class="pl-pds">'</span></span>, req, <span class="pl-k">function</span>(<span class="pl-smi">data</span>) {</span>
<span class="pl-s1">      <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>normal<span class="pl-pds">'</span></span>, req.val, data);</span>
<span class="pl-s1">    });</span>
<span class="pl-s1"></span>
<span class="pl-s1">    socket2.emit(<span class="pl-s"><span class="pl-pds">'</span>randomRequest<span class="pl-pds">'</span></span>, req2, <span class="pl-k">function</span>(<span class="pl-smi">data</span>) {</span>
<span class="pl-s1">      <span class="pl-en">console</span><span class="pl-c1">.log</span>(<span class="pl-s"><span class="pl-pds">'</span>ns<span class="pl-pds">'</span></span>, req2.val, data);</span>
<span class="pl-s1">    });</span>
<span class="pl-s1">  }, <span class="pl-c1">3000</span>)</span>
<span class="pl-s1"></span>
<span class="pl-s1">&lt;/<span class="pl-ent">script</span>&gt;</span></pre></div>

<p><code>sockend.js</code></p>

<div class="highlight highlight-js"><pre><span class="pl-k">var</span> app <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>http<span class="pl-pds">'</span></span>).createServer(handler)
  , io <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>socket.io<span class="pl-pds">'</span></span>).listen(app)
  , fs <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>fs<span class="pl-pds">'</span></span>)

app.listen(<span class="pl-c1">5555</span>);

<span class="pl-k">function</span> <span class="pl-en">handler</span> (<span class="pl-smi">req</span>, <span class="pl-smi">res</span>) {
  fs.readFile(<span class="pl-c1">__dirname</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>/index.html<span class="pl-pds">'</span></span>,
  <span class="pl-k">function</span> (<span class="pl-smi">err</span>, <span class="pl-smi">data</span>) {
    <span class="pl-k">if</span> (err) {
      res.writeHead(<span class="pl-c1">500</span>);
      <span class="pl-k">return</span> res.end(<span class="pl-s"><span class="pl-pds">'</span>Error loading index.html<span class="pl-pds">'</span></span>);
    }

    res.writeHead(<span class="pl-c1">200</span>);
    res.end(data);
  });
};

<span class="pl-k">var</span> sockend <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">require</span>(<span class="pl-s"><span class="pl-pds">'</span>../../<span class="pl-pds">'</span></span>).Sockend(io, {
  name<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>sockend<span class="pl-pds">'</span></span>
});</pre></div>

<p>Now, fire up a few Responders and Publishers on default or 'rnd' namespace and watch them glow with magic on <code>http://localhost:5555</code>.</p>

<h3>
<a id="monitor" class="anchor" href="#monitor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Monitor</h3>

<p>Monitor is the "top" of cote. It lists all the daemons it discovers regardless of namespace or key. Run <code>examples/monitor.js</code> and see all your active cote daemons.</p>

<h2>
<a id="mit-license" class="anchor" href="#mit-license" aria-hidden="true"><span class="octicon octicon-link"></span></a>MIT License</h2>

<p>Copyright (c) 2013 Armagan Amcalar <a href="mailto:armagan@amcalar.com">armagan@amcalar.com</a></p>

<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>

<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>

<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/dashersw/cote">Cote</a> is maintained by <a href="https://github.com/dashersw">dashersw</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

